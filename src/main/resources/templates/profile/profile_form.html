<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <!-- userId 유무로 타이틀 분기 -->
    <title th:text="${profileDTO.userId} != null
                  ? '프로필 수정'
                  : '새 프로필 만들기'">
        프로필 폼
    </title>
</head>
<body>
<h2 th:text="${profileDTO.userId} != null
              ? '프로필 수정'
              : '새 프로필 만들기'">
    프로필 폼
</h2>

<form th:object="${profileDTO}"
      th:action="${profileDTO.userId} != null
                  ? @{/users/profiles/{userId}(userId=${profileDTO.userId})}
                  : @{/users/profiles}"
      method="post"
      enctype="multipart/form-data">

    <!-- 닉네임 -->
    <div>
        <label for="nickname">닉네임</label>
        <input type="text" id="nickname" th:field="*{nickname}" required/>
        <p th:if="${#fields.hasErrors('nickname')}"
           th:errors="*{nickname}">닉네임 에러</p>
    </div>

    <!-- 기술 스택 -->
    <div>
        <label for="stacks">기술 스택</label>
        <input type="text" id="stacks" th:field="*{stacks}" required />
        <p th:if="${#fields.hasErrors('stacks')}"
           th:errors="*{stacks}">스택 에러</p>
    </div>

    <!-- 경력 -->
    <div>
        <label for="experience">경력 정보</label>
        <input type="text" id="experience" th:field="*{experience}" required/>
        <p th:if="${#fields.hasErrors('experience')}"
           th:errors="*{experience}">경력 에러</p>
    </div>

    <!-- 자기소개 -->
    <div>
        <label for="selfInfo">자기소개</label>
        <textarea id="selfInfo" th:field="*{selfInfo}" required></textarea>
        <p th:if="${#fields.hasErrors('selfInfo')}"
           th:errors="*{selfInfo}">소개 에러</p>
    </div>

    <!-- 이미지 업로드 -->
    <div>
        <label for="file">프로필 이미지</label>
        <input type="file" id="file" name="file"/>
        <div th:if="${profileDTO.imageUrl}">
            <p>현재 이미지:</p>
            <img th:src="${profileDTO.imageUrl}"
                 alt="프로필 이미지"
                 style="max-width:200px; border:1px solid #ccc;"/>
        </div>
    </div>

    <!-- 기업 공개 여부 -->
    <div>
        <label for="allowCompanyAccess">기업 공개</label>
        <input type="checkbox" id="allowCompanyAccess"
               th:field="*{allowCompanyAccess}"  required/>
        <p th:if="${#fields.hasErrors('allowCompanyAccess')}"
           th:errors="*{allowCompanyAccess}">공개 여부 에러</p>
    </div>

    <button type="submit">저장</button>
    <a th:href="@{/users/profiles}">취소</a>
</form>
</body>
</html>
